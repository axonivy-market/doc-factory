[Ivy]
[>Created: Mon Aug 26 13:17:09 CEST 2013]
125F850DA67753A5 3.17 #module
>Proto >Proto Collection #zClass
Ds0 DesktopHandlerProcess Big #zClass
Ds0 RD #cInfo
Ds0 #process
Ds0 @AnnotationInP-0n ai ai #zField
Ds0 @TextInP .ui2RdDataAction .ui2RdDataAction #zField
Ds0 @TextInP .rdData2UIAction .rdData2UIAction #zField
Ds0 @TextInP .resExport .resExport #zField
Ds0 @TextInP .type .type #zField
Ds0 @TextInP .processKind .processKind #zField
Ds0 @TextInP .xml .xml #zField
Ds0 @TextInP .responsibility .responsibility #zField
Ds0 @MessageFlowInP-0n messageIn messageIn #zField
Ds0 @MessageFlowOutP-0n messageOut messageOut #zField
Ds0 @RichDialogInitStart f0 '' #zField
Ds0 @RichDialogProcessEnd f1 '' #zField
Ds0 @RichDialogProcessStep f2 '' #zField
Ds0 @PushWFArc f3 '' #zField
Ds0 @RichDialogMethodStart f5 '' #zField
Ds0 @RichDialogFireEvent f6 '' #zField
Ds0 @PushWFArc f7 '' #zField
Ds0 @RichDialogProcessEnd f8 '' #zField
Ds0 @PushWFArc f9 '' #zField
Ds0 @RichDialogMethodStart f10 '' #zField
Ds0 @RichDialogProcessStep f11 '' #zField
Ds0 @PushWFArc f12 '' #zField
Ds0 @RichDialogProcessEnd f13 '' #zField
Ds0 @PushWFArc f14 '' #zField
Ds0 @RichDialogMethodStart f15 '' #zField
Ds0 @RichDialogMethodStart f16 '' #zField
Ds0 @RichDialogMethodStart f17 '' #zField
Ds0 @RichDialogMethodStart f18 '' #zField
Ds0 @RichDialogProcessStep f19 '' #zField
Ds0 @PushWFArc f20 '' #zField
Ds0 @RichDialogProcessEnd f21 '' #zField
Ds0 @PushWFArc f22 '' #zField
Ds0 @RichDialogMethodStart f23 '' #zField
Ds0 @RichDialogProcessStep f24 '' #zField
Ds0 @PushWFArc f25 '' #zField
Ds0 @RichDialogProcessEnd f26 '' #zField
Ds0 @PushWFArc f27 '' #zField
Ds0 @RichDialogMethodStart f28 '' #zField
Ds0 @RichDialogProcessStep f29 '' #zField
Ds0 @RichDialogProcessEnd f30 '' #zField
Ds0 @PushWFArc f31 '' #zField
Ds0 @PushWFArc f32 '' #zField
Ds0 @RichDialogProcessEnd f33 '' #zField
Ds0 @PushWFArc f34 '' #zField
Ds0 @RichDialogProcessEnd f35 '' #zField
Ds0 @PushWFArc f36 '' #zField
Ds0 @RichDialogProcessEnd f37 '' #zField
Ds0 @PushWFArc f38 '' #zField
Ds0 @RichDialogMethodStart f39 '' #zField
Ds0 @RichDialogProcessStep f40 '' #zField
Ds0 @PushWFArc f41 '' #zField
Ds0 @RichDialogProcessEnd f42 '' #zField
Ds0 @PushWFArc f43 '' #zField
Ds0 @RichDialogMethodStart f44 '' #zField
Ds0 @RichDialogProcessEnd f45 '' #zField
Ds0 @PushWFArc f46 '' #zField
Ds0 @RichDialogMethodStart f47 '' #zField
Ds0 @RichDialogMethodStart f48 '' #zField
Ds0 @RichDialogProcessStep f49 '' #zField
Ds0 @PushWFArc f50 '' #zField
Ds0 @RichDialogProcessEnd f51 '' #zField
Ds0 @PushWFArc f52 '' #zField
Ds0 @RichDialogProcessEnd f53 '' #zField
Ds0 @PushWFArc f54 '' #zField
Ds0 @RichDialogMethodStart f55 '' #zField
Ds0 @RichDialogProcessStep f56 '' #zField
Ds0 @PushWFArc f57 '' #zField
Ds0 @RichDialogProcessEnd f58 '' #zField
Ds0 @PushWFArc f59 '' #zField
Ds0 @RichDialogInitStart f60 '' #zField
Ds0 @PushWFArc f61 '' #zField
Ds0 @RichDialogMethodStart f62 '' #zField
Ds0 @RichDialogProcessEnd f63 '' #zField
Ds0 @PushWFArc f64 '' #zField
Ds0 @RichDialogProcessStart f65 '' #zField
Ds0 @RichDialogProcessStep f66 '' #zField
Ds0 @PushWFArc f67 '' #zField
Ds0 @RichDialogProcessEnd f68 '' #zField
Ds0 @PushWFArc f69 '' #zField
Ds0 @RichDialogMethodStart f70 '' #zField
Ds0 @RichDialogProcessEnd f71 '' #zField
Ds0 @PushWFArc f72 '' #zField
Ds0 @RichDialogMethodStart f75 '' #zField
Ds0 @RichDialogMethodStart f76 '' #zField
Ds0 @RichDialogProcessStep f77 '' #zField
Ds0 @RichDialogProcessStep f78 '' #zField
Ds0 @PushWFArc f79 '' #zField
Ds0 @RichDialogProcessEnd f80 '' #zField
Ds0 @PushWFArc f81 '' #zField
Ds0 @PushWFArc f82 '' #zField
Ds0 @RichDialogProcessEnd f83 '' #zField
Ds0 @PushWFArc f84 '' #zField
Ds0 @RichDialogMethodStart f85 '' #zField
Ds0 @RichDialogProcessEnd f86 '' #zField
Ds0 @RichDialogMethodStart f88 '' #zField
Ds0 @RichDialogProcessEnd f89 '' #zField
Ds0 @PushWFArc f4 '' #zField
Ds0 @RichDialogFireEvent f73 '' #zField
Ds0 @PushWFArc f74 '' #zField
Ds0 @PushWFArc f87 '' #zField
Ds0 @RichDialogFireEvent f91 '' #zField
Ds0 @PushWFArc f92 '' #zField
Ds0 @PushWFArc f90 '' #zField
Ds0 @RichDialogMethodStart f93 '' #zField
Ds0 @RichDialogProcessStep f94 '' #zField
Ds0 @PushWFArc f95 '' #zField
Ds0 @RichDialogProcessEnd f96 '' #zField
Ds0 @PushWFArc f97 '' #zField
Ds0 @RichDialogMethodStart f98 '' #zField
Ds0 @RichDialogProcessStep f99 '' #zField
Ds0 @PushWFArc f100 '' #zField
Ds0 @RichDialogProcessEnd f101 '' #zField
Ds0 @PushWFArc f102 '' #zField
Ds0 @RichDialogProcessStart f103 '' #zField
Ds0 @RichDialogProcessEnd f104 '' #zField
Ds0 @PushWFArc f105 '' #zField
Ds0 @InfoButton f106 '' #zField
Ds0 @RichDialogMethodStart f107 '' #zField
Ds0 @RichDialogProcessEnd f108 '' #zField
Ds0 @PushWFArc f109 '' #zField
Ds0 @RichDialogMethodStart f110 '' #zField
Ds0 @RichDialogProcessStep f111 '' #zField
Ds0 @PushWFArc f112 '' #zField
Ds0 @RichDialogProcessEnd f113 '' #zField
Ds0 @PushWFArc f114 '' #zField
Ds0 @RichDialogProcessStep f116 '' #zField
Ds0 @RichDialogProcessEnd f118 '' #zField
Ds0 @PushWFArc f119 '' #zField
Ds0 @RichDialogProcessStep f121 '' #zField
Ds0 @PushWFArc f123 '' #zField
Ds0 @RichDialogMethodStart f124 '' #zField
Ds0 @PushWFArc f115 '' #zField
Ds0 @RichDialogMethodStart f117 '' #zField
Ds0 @PushWFArc f120 '' #zField
Ds0 @RichDialogMethodStart f122 '' #zField
Ds0 @RichDialogMethodStart f132 '' #zField
Ds0 @RichDialogProcessStep f133 '' #zField
Ds0 @PushWFArc f134 '' #zField
Ds0 @RichDialogProcessStep f135 '' #zField
Ds0 @PushWFArc f136 '' #zField
Ds0 @RichDialogProcessEnd f137 '' #zField
Ds0 @PushWFArc f138 '' #zField
Ds0 @RichDialogMethodStart f139 '' #zField
Ds0 @PushWFArc f140 '' #zField
Ds0 @RichDialogMethodStart f142 '' #zField
Ds0 @RichDialogMethodStart f141 '' #zField
Ds0 @RichDialogMethodStart f143 '' #zField
Ds0 @RichDialogMethodStart f144 '' #zField
Ds0 @RichDialogProcessStep f145 '' #zField
Ds0 @PushWFArc f146 '' #zField
Ds0 @RichDialogProcessStep f147 '' #zField
Ds0 @PushWFArc f148 '' #zField
Ds0 @RichDialogProcessEnd f152 '' #zField
Ds0 @RichDialogProcessEnd f153 '' #zField
Ds0 @PushWFArc f154 '' #zField
Ds0 @PushWFArc f155 '' #zField
Ds0 @RichDialogProcessEnd f156 '' #zField
Ds0 @RichDialogProcessEnd f158 '' #zField
Ds0 @PushWFArc f159 '' #zField
Ds0 @RichDialogFireEvent f160 '' #zField
Ds0 @PushWFArc f161 '' #zField
Ds0 @PushWFArc f157 '' #zField
Ds0 @RichDialogProcessStep f162 '' #zField
Ds0 @PushWFArc f163 '' #zField
Ds0 @RichDialogProcessEnd f128 '' #zField
Ds0 @PushWFArc f164 '' #zField
Ds0 @RichDialogInitStart f165 '' #zField
Ds0 @PushWFArc f166 '' #zField
Ds0 @RichDialogMethodStart f167 '' #zField
Ds0 @RichDialogMethodStart f168 '' #zField
Ds0 @RichDialogProcessEnd f169 '' #zField
Ds0 @PushWFArc f170 '' #zField
Ds0 @RichDialogProcessStep f171 '' #zField
Ds0 @PushWFArc f172 '' #zField
Ds0 @RichDialogProcessEnd f173 '' #zField
Ds0 @PushWFArc f174 '' #zField
Ds0 @RichDialogMethodStart f175 '' #zField
Ds0 @RichDialogProcessStep f176 '' #zField
Ds0 @PushWFArc f177 '' #zField
Ds0 @RichDialogProcessEnd f178 '' #zField
Ds0 @PushWFArc f179 '' #zField
Ds0 @RichDialogMethodStart f180 '' #zField
Ds0 @RichDialogProcessStep f183 '' #zField
Ds0 @RichDialogProcessEnd f185 '' #zField
Ds0 @PushWFArc f186 '' #zField
Ds0 @PushWFArc f187 '' #zField
Ds0 @RichDialogMethodStart f125 '' #zField
Ds0 @RichDialogProcessStep f126 '' #zField
Ds0 @PushWFArc f127 '' #zField
Ds0 @RichDialogFireEvent f129 '' #zField
Ds0 @PushWFArc f130 '' #zField
Ds0 @RichDialogProcessEnd f131 '' #zField
Ds0 @PushWFArc f181 '' #zField
Ds0 @RichDialogMethodStart f182 '' #zField
Ds0 @RichDialogProcessStep f184 '' #zField
Ds0 @PushWFArc f188 '' #zField
Ds0 @RichDialogProcessEnd f189 '' #zField
Ds0 @PushWFArc f190 '' #zField
Ds0 @RichDialogMethodStart f191 '' #zField
Ds0 @RichDialogProcessStep f192 '' #zField
Ds0 @PushWFArc f193 '' #zField
Ds0 @RichDialogProcessEnd f194 '' #zField
Ds0 @PushWFArc f195 '' #zField
Ds0 @AnnotationArc f196 '' #zField
Ds0 @RichDialogMethodStart f197 '' #zField
Ds0 @RichDialogProcessStep f198 '' #zField
Ds0 @PushWFArc f199 '' #zField
Ds0 @RichDialogProcessEnd f200 '' #zField
Ds0 @PushWFArc f201 '' #zField
Ds0 @RichDialogMethodStart f202 '' #zField
Ds0 @RichDialogProcessEnd f203 '' #zField
Ds0 @PushWFArc f204 '' #zField
Ds0 @RichDialogMethodStart f149 '' #zField
Ds0 @RichDialogProcessEnd f150 '' #zField
Ds0 @PushWFArc f151 '' #zField
>Proto Ds0 Ds0 DesktopHandlerProcess #zField
Ds0 f0 guid 11E20AE1BA5352AB #txt
Ds0 f0 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f0 method start() #txt
Ds0 f0 disableUIEvents false #txt
Ds0 f0 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f0 inParameterMapAction 'out.baseTempDir="";
out.tableVisible=false;
' #txt
Ds0 f0 outParameterDecl '<> result;
' #txt
Ds0 f0 embeddedRdInitializations '{/fileEditorCheckerPanel {/fieldName "fileEditorCheckerPanel"/startMethod "start()"/parameterMapping ""/initScript ""}}' #txt
Ds0 f0 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>start()</name>
        <nameStyle>7,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f0 158 134 20 20 13 0 #rect
Ds0 f0 @|RichDialogInitStartIcon #fIcon
Ds0 f1 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f1 91 267 26 26 14 0 #rect
Ds0 f1 @|RichDialogProcessEndIcon #fIcon
Ds0 f2 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f2 actionTable 'out=in;
' #txt
Ds0 f2 actionCode 'import com.ulcjava.base.application.border.ULCTitledBorder;
import ch.ivyteam.ivy.addons.filemanager.ulcextensionhandler.UserSystemPropertiesHandler;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
import ch.ivyteam.ivy.addons.filemanager.ulcextensionhandler.DesktopHandler;

//get the client java properties
in.userPropertiesHandler = new UserSystemPropertiesHandler(panel,"_getUserNameCallBack","_getUserTempDirCallBack","_getClientFileSeparatorCallBack");
//make the Desktop Java 6 Implementation Handler object
in.DesktopHandlerObject = new DesktopHandler(panel,"_DesktopException","_callBackIsFileEditable","_callBackIsFilePrintable", true);

//Make the client temp dir if indicated
if(in.clientApplicationTempDir.trim().length()>0){
	in.clientApplicationTempDir=FileHandler.formatPathWithEndSeparator(in.clientApplicationTempDir,false);
}
import ch.ivyteam.ivy.addons.filemanager.ulcextensionhandler.UserTempDirectoryManager;
in.userTempDirectoryManager = new UserTempDirectoryManager(in.clientApplicationTempDir,panel,"_newTempDirCreated","");


try{
	ULCTitledBorder b = panel.ScrollPane.getBorder() as ULCTitledBorder;
	b.setTitle(ivy.cms.co("/ch/ivyteam/ivy/addons/filemanager/DesktopHandler/labels/border"));
}catch(Throwable t)
{
		
}' #txt
Ds0 f2 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f2 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f2 86 196 36 24 20 -2 #rect
Ds0 f2 @|RichDialogProcessStepIcon #fIcon
Ds0 f3 expr out #txt
Ds0 f3 160 151 116 196 #arcP
Ds0 f5 guid 11E20CEA5FA8F2E9 #txt
Ds0 f5 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f5 method _DesktopException(String) #txt
Ds0 f5 disableUIEvents false #txt
Ds0 f5 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String errorMessage> param = methodEvent.getInputArguments();
' #txt
Ds0 f5 inParameterMapAction 'out.errorMessage=param.errorMessage;
' #txt
Ds0 f5 outParameterDecl '<> result;
' #txt
Ds0 f5 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_DesktopException(String)</name>
        <nameStyle>25,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f5 54 510 20 20 -51 -33 #rect
Ds0 f5 @|RichDialogMethodStartIcon #fIcon
Ds0 f6 actionDecl 'String errorMessage;
' #txt
Ds0 f6 actionTable 'errorMessage=in.errorMessage;
' #txt
Ds0 f6 actionCode panel.fireDesktopException(errorMessage); #txt
Ds0 f6 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f6 fireEvent desktopException(String) #txt
Ds0 f6 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>fires desktopException 
event</name>
        <nameStyle>29,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f6 46 588 36 24 26 -14 #rect
Ds0 f6 @|RichDialogFireEventIcon #fIcon
Ds0 f7 expr out #txt
Ds0 f7 64 530 64 588 #arcP
Ds0 f8 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f8 51 667 26 26 14 0 #rect
Ds0 f8 @|RichDialogProcessEndIcon #fIcon
Ds0 f9 expr out #txt
Ds0 f9 64 612 64 667 #arcP
Ds0 f10 guid 11E20D12C9A6DBB4 #txt
Ds0 f10 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f10 method editFile(java.io.File) #txt
Ds0 f10 disableUIEvents false #txt
Ds0 f10 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f10 inParameterMapAction 'out.fileToWorkWith=param.file;
' #txt
Ds0 f10 outParameterDecl '<> result;
' #txt
Ds0 f10 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>editFile(File)</name>
        <nameStyle>14,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f10 294 110 20 20 -24 -31 #rect
Ds0 f10 @|RichDialogMethodStartIcon #fIcon
Ds0 f11 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f11 actionTable 'out=in;
' #txt
Ds0 f11 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
FileCouple fc = new FileCouple();
boolean b = false;
boolean alreadyOpened=false;
if(in.#fileToWorkWith!=null){
	for(FileCouple f: in.editedFileList){
		//we found that this file is currently edited
		if(f.getServerFile().getPath().equals(in.fileToWorkWith.getPath())){
			alreadyOpened = true;
			//we open the file where she is
			if(in.#DesktopHandlerObject!=null){
				in.DesktopHandlerObject.openFile(f.clientFile);
			}
			if(alreadyOpened){
				break;
			}
		}
	}
	if(!alreadyOpened){
		// if not already opened, we make the unique temp dir for it
		// the temp dir manager will inform the RDPanel as soon as the temp dir was created,
		// we will then edit the file
		String s= System.nanoTime().toString();
		FileAndTempDirCouple ftd = new FileAndTempDirCouple();
		ftd.file = in.fileToWorkWith;
		ftd.tempDirName = s;
		ftd.isFileEditable = true;
		in.filesToEdit.add(ftd);
		in.userTempDirectoryManager.makeTempDir(s);
		
	}
}' #txt
Ds0 f11 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f11 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f11 286 172 36 24 20 -2 #rect
Ds0 f11 @|RichDialogProcessStepIcon #fIcon
Ds0 f12 expr out #txt
Ds0 f12 304 130 304 172 #arcP
Ds0 f13 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f13 291 227 26 26 14 0 #rect
Ds0 f13 @|RichDialogProcessEndIcon #fIcon
Ds0 f14 expr out #txt
Ds0 f14 304 196 304 227 #arcP
Ds0 f15 guid 11E20D8DC0F20905 #txt
Ds0 f15 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f15 method getClientTempPath() #txt
Ds0 f15 disableUIEvents false #txt
Ds0 f15 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f15 outParameterDecl '<java.lang.String clientTempPath> result;
' #txt
Ds0 f15 outParameterMapAction 'result.clientTempPath=in.clientTempPath;
' #txt
Ds0 f15 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getClientTempPath()</name>
        <nameStyle>19,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f15 966 86 20 20 -41 -38 #rect
Ds0 f15 @|RichDialogMethodStartIcon #fIcon
Ds0 f16 guid 11E20D8FD9FE0681 #txt
Ds0 f16 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f16 method getEditedFileList() #txt
Ds0 f16 disableUIEvents false #txt
Ds0 f16 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f16 outParameterDecl '<List<ch.ivyteam.ivy.addons.filemanager.FileCouple> fileList> result;
' #txt
Ds0 f16 outParameterMapAction 'result.fileList=in.editedFileList;
' #txt
Ds0 f16 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getEditedFileList()</name>
        <nameStyle>19,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f16 1078 86 20 20 -35 -34 #rect
Ds0 f16 @|RichDialogMethodStartIcon #fIcon
Ds0 f17 guid 11E20D9167627AC6 #txt
Ds0 f17 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f17 method getEmailParamList() #txt
Ds0 f17 disableUIEvents false #txt
Ds0 f17 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f17 outParameterDecl '<List<java.lang.String> emailParams> result;
' #txt
Ds0 f17 outParameterMapAction 'result.emailParams=in.mailParamList;
' #txt
Ds0 f17 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getEmailParamList()</name>
        <nameStyle>19,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f17 966 206 20 20 -38 -36 #rect
Ds0 f17 @|RichDialogMethodStartIcon #fIcon
Ds0 f18 guid 11E20D9276D7A136 #txt
Ds0 f18 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f18 method mail() #txt
Ds0 f18 disableUIEvents false #txt
Ds0 f18 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>mail()</name>
    </language>
</elementInfo>
' #txt
Ds0 f18 294 358 20 20 -13 -35 #rect
Ds0 f18 @|RichDialogMethodStartIcon #fIcon
Ds0 f19 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f19 actionTable 'out=in;
' #txt
Ds0 f19 actionCode 'if(in.#DesktopHandlerObject!=null){
			in.DesktopHandlerObject.mail();
}' #txt
Ds0 f19 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f19 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f19 286 428 36 24 20 -2 #rect
Ds0 f19 @|RichDialogProcessStepIcon #fIcon
Ds0 f20 expr out #txt
Ds0 f20 304 378 304 428 #arcP
Ds0 f21 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f21 291 499 26 26 14 0 #rect
Ds0 f21 @|RichDialogProcessEndIcon #fIcon
Ds0 f22 expr out #txt
Ds0 f22 304 452 304 499 #arcP
Ds0 f23 guid 11E20DA1FCC491C2 #txt
Ds0 f23 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f23 method mailWithParameters(List<String>) #txt
Ds0 f23 disableUIEvents false #txt
Ds0 f23 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<java.lang.String> listOfParameters> param = methodEvent.getInputArguments();
' #txt
Ds0 f23 inParameterMapAction 'out.mailParamList=param.listOfParameters;
' #txt
Ds0 f23 outParameterDecl '<> result;
' #txt
Ds0 f23 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>mailWithParameters(List&lt;String&gt;)</name>
        <nameStyle>32,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f23 406 358 20 20 -62 -38 #rect
Ds0 f23 @|RichDialogMethodStartIcon #fIcon
Ds0 f24 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f24 actionTable 'out=in;
' #txt
Ds0 f24 actionCode 'if(in.#DesktopHandlerObject!=null){
	if(in.mailParamList.size()!= 6){
		panel._DesktopException("Invalid number of parameters for this method");
	}
	else{
			in.DesktopHandlerObject.mailMessage(in.mailParamList.get(0),
			in.mailParamList.get(1),
			in.mailParamList.get(2),
			in.mailParamList.get(3),
			in.mailParamList.get(4),
			in.mailParamList.get(5));
	}
}' #txt
Ds0 f24 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f24 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f24 398 428 36 24 20 -2 #rect
Ds0 f24 @|RichDialogProcessStepIcon #fIcon
Ds0 f25 expr out #txt
Ds0 f25 416 378 416 428 #arcP
Ds0 f26 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f26 403 499 26 26 14 0 #rect
Ds0 f26 @|RichDialogProcessEndIcon #fIcon
Ds0 f27 expr out #txt
Ds0 f27 416 452 416 499 #arcP
Ds0 f28 guid 11E20DE9CAA33F43 #txt
Ds0 f28 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f28 method openFile(java.io.File) #txt
Ds0 f28 disableUIEvents false #txt
Ds0 f28 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f28 inParameterMapAction 'out.fileToWorkWith=param.file;
' #txt
Ds0 f28 outParameterDecl '<> result;
' #txt
Ds0 f28 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openFile(File)</name>
        <nameStyle>14,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f28 406 110 20 20 -31 -29 #rect
Ds0 f28 @|RichDialogMethodStartIcon #fIcon
Ds0 f29 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f29 actionTable 'out=in;
' #txt
Ds0 f29 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileHandler;
import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
in.baseTempDir=FileHandler.formatPathWithEndSeparator(in.clientTempPath+in.clientApplicationTempDir,false);
if(!in.userPropertiesHandler.getUserTempDir().trim().equalsIgnoreCase("")){
	in.clientTempPath=in.userPropertiesHandler.getUserTempDir();
}
boolean b = false;
boolean alreadyOpened=false;
if(in.#fileToWorkWith!=null){
	for(FileCouple f: in.filesInReading){
		//we found that this file is currently edited
		if(f.getServerFile().getPath().equals(in.fileToWorkWith.getPath())){
			alreadyOpened = true;
			//we open the file where she is
			if(in.#DesktopHandlerObject!=null){
				in.DesktopHandlerObject.openFile(f.clientFile,true);
			}
			if(alreadyOpened){
				break;
			}
		}
	}
	if(!alreadyOpened){
		// if not already opened, we make the unique temp dir for it
		// the temp dir manager will inform the RDPanel as soon as the temp dir was created,
		// we will then open the file in read only mode
		String s= System.nanoTime().toString();
		FileAndTempDirCouple ftd = new FileAndTempDirCouple();
		ftd.file = in.fileToWorkWith;
		ftd.tempDirName = s;
		ftd.isFileEditable = false;
		in.filesToEdit.add(ftd);
		in.userTempDirectoryManager.makeTempDir(s);
	}
	/*
	b=FileHandler.download(in.fileToWorkWith,in.clientTempPath);
	if(b){
		java.io.File file = new java.io.File(in.clientTempPath+in.fileToWorkWith.getName());
		if(in.#DesktopHandlerObject!=null){
			in.DesktopHandlerObject.openFile(file, true);
		}else{
			in.errorMessage="Could''nt download the file "+in.fileToWorkWith.getPath();
			panel._DesktopException(in.errorMessage);
		}
	}
	*/
}else{
	in.errorMessage="No file selected";
	panel._DesktopException(in.errorMessage);
}
' #txt
Ds0 f29 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f29 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f29 398 172 36 24 20 -2 #rect
Ds0 f29 @|RichDialogProcessStepIcon #fIcon
Ds0 f30 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f30 403 227 26 26 14 0 #rect
Ds0 f30 @|RichDialogProcessEndIcon #fIcon
Ds0 f31 expr out #txt
Ds0 f31 416 196 416 227 #arcP
Ds0 f32 expr out #txt
Ds0 f32 416 130 416 172 #arcP
Ds0 f33 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f33 963 123 26 26 14 0 #rect
Ds0 f33 @|RichDialogProcessEndIcon #fIcon
Ds0 f34 expr out #txt
Ds0 f34 976 106 976 123 #arcP
Ds0 f35 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f35 1075 131 26 26 14 0 #rect
Ds0 f35 @|RichDialogProcessEndIcon #fIcon
Ds0 f36 expr out #txt
Ds0 f36 1088 106 1088 131 #arcP
Ds0 f37 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f37 963 267 26 26 14 0 #rect
Ds0 f37 @|RichDialogProcessEndIcon #fIcon
Ds0 f38 expr out #txt
Ds0 f38 976 226 976 267 #arcP
Ds0 f39 guid 11E20E0E4AD76A1D #txt
Ds0 f39 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f39 method setClientTempPath(String) #txt
Ds0 f39 disableUIEvents false #txt
Ds0 f39 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String clientTempPath> param = methodEvent.getInputArguments();
' #txt
Ds0 f39 inParameterMapAction 'out.clientTempPath=param.clientTempPath;
' #txt
Ds0 f39 outParameterDecl '<> result;
' #txt
Ds0 f39 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setClientTempPath(String)</name>
        <nameStyle>25,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f39 966 366 20 20 -47 -32 #rect
Ds0 f39 @|RichDialogMethodStartIcon #fIcon
Ds0 f40 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f40 actionTable 'out=in;
' #txt
Ds0 f40 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileHandler;
in.clientTempPath=FileHandler.formatPathWithEndSeparator(in.clientTempPath);' #txt
Ds0 f40 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f40 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f40 958 420 36 24 20 -2 #rect
Ds0 f40 @|RichDialogProcessStepIcon #fIcon
Ds0 f41 expr out #txt
Ds0 f41 976 386 976 420 #arcP
Ds0 f42 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f42 963 475 26 26 14 0 #rect
Ds0 f42 @|RichDialogProcessEndIcon #fIcon
Ds0 f43 expr out #txt
Ds0 f43 976 444 976 475 #arcP
Ds0 f44 guid 11E20E27CB19B4F7 #txt
Ds0 f44 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f44 method setEmailParamList(List<String>) #txt
Ds0 f44 disableUIEvents false #txt
Ds0 f44 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<java.lang.String> emailParams> param = methodEvent.getInputArguments();
' #txt
Ds0 f44 inParameterMapAction 'out.mailParamList=param.emailParams;
' #txt
Ds0 f44 outParameterDecl '<> result;
' #txt
Ds0 f44 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setEmailParamList(List&lt;String&gt;)</name>
        <nameStyle>31,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f44 1110 366 20 20 -59 -30 #rect
Ds0 f44 @|RichDialogMethodStartIcon #fIcon
Ds0 f45 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f45 1107 419 26 26 14 0 #rect
Ds0 f45 @|RichDialogProcessEndIcon #fIcon
Ds0 f46 expr out #txt
Ds0 f46 1120 386 1120 419 #arcP
Ds0 f47 guid 11E25D87AE87DE1E #txt
Ds0 f47 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f47 method getEditCheckPeriod() #txt
Ds0 f47 disableUIEvents false #txt
Ds0 f47 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f47 outParameterDecl '<java.lang.Number editCheckPeriod> result;
' #txt
Ds0 f47 outParameterMapAction 'result.editCheckPeriod=in.editCheckPeriod;
' #txt
Ds0 f47 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getEditCheckPeriod()</name>
        <nameStyle>20,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f47 1110 510 20 20 -46 -35 #rect
Ds0 f47 @|RichDialogMethodStartIcon #fIcon
Ds0 f48 guid 11E25D897B786215 #txt
Ds0 f48 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f48 method setEditCheckPeriod(Number) #txt
Ds0 f48 disableUIEvents false #txt
Ds0 f48 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Number editCheckPeriod> param = methodEvent.getInputArguments();
' #txt
Ds0 f48 inParameterMapAction 'out.editCheckPeriod=param.editCheckPeriod;
' #txt
Ds0 f48 outParameterDecl '<> result;
' #txt
Ds0 f48 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setEditCheckPeriod(Number)</name>
        <nameStyle>26,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f48 966 550 20 20 -45 -32 #rect
Ds0 f48 @|RichDialogMethodStartIcon #fIcon
Ds0 f49 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f49 actionTable 'out=in;
' #txt
Ds0 f49 actionCode panel.fileEditorCheckerPanel.setCheckPeriod(in.editCheckPeriod); #txt
Ds0 f49 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f49 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f49 958 596 36 24 20 -2 #rect
Ds0 f49 @|RichDialogProcessStepIcon #fIcon
Ds0 f50 expr out #txt
Ds0 f50 976 570 976 596 #arcP
Ds0 f51 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f51 963 643 26 26 14 0 #rect
Ds0 f51 @|RichDialogProcessEndIcon #fIcon
Ds0 f52 expr out #txt
Ds0 f52 976 620 976 643 #arcP
Ds0 f53 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f53 1107 571 26 26 14 0 #rect
Ds0 f53 @|RichDialogProcessEndIcon #fIcon
Ds0 f54 expr out #txt
Ds0 f54 1120 530 1120 571 #arcP
Ds0 f55 guid 11E25DD5BF874B46 #txt
Ds0 f55 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f55 method removeFileToEdit(java.io.File) #txt
Ds0 f55 disableUIEvents false #txt
Ds0 f55 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File fileToRemove> param = methodEvent.getInputArguments();
' #txt
Ds0 f55 inParameterMapAction 'out.fileToDeleteFromCheck=param.fileToRemove;
' #txt
Ds0 f55 outParameterDecl '<> result;
' #txt
Ds0 f55 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>removeFileToEdit(File)</name>
        <nameStyle>22,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f55 286 566 20 20 -29 -29 #rect
Ds0 f55 @|RichDialogMethodStartIcon #fIcon
Ds0 f56 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f56 actionTable 'out=in;
' #txt
Ds0 f56 actionCode 'for(int i=0; i<in.editedFileList.size(); i++){
	if(in.fileToDeleteFromCheck.getPath().equals(in.editedFileList.get(i).serverFile.getPath())){
		in.editedFileList.removeAt(i);
		break;
	}
}
panel.fileEditorCheckerPanel.setFileCouplesList(in.editedFileList);' #txt
Ds0 f56 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f56 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f56 278 628 36 24 20 -2 #rect
Ds0 f56 @|RichDialogProcessStepIcon #fIcon
Ds0 f57 expr out #txt
Ds0 f57 296 586 296 628 #arcP
Ds0 f58 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f58 283 691 26 26 14 0 #rect
Ds0 f58 @|RichDialogProcessEndIcon #fIcon
Ds0 f59 expr out #txt
Ds0 f59 296 652 296 691 #arcP
Ds0 f60 guid 11E2651C12166606 #txt
Ds0 f60 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f60 method startVisible(Boolean) #txt
Ds0 f60 disableUIEvents false #txt
Ds0 f60 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Boolean visible> param = methodEvent.getInputArguments();
' #txt
Ds0 f60 inParameterMapAction 'out.baseTempDir="";
out.tableVisible=param.visible;
' #txt
Ds0 f60 outParameterDecl '<> result;
' #txt
Ds0 f60 embeddedRdInitializations '{/fileEditorCheckerPanel {/fieldName "fileEditorCheckerPanel"/startMethod "start()"/parameterMapping ""/initScript ""/userContext * }}' #txt
Ds0 f60 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>startVisible(Boolean)</name>
        <nameStyle>21,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f60 14 134 20 20 11 -20 #rect
Ds0 f60 @|RichDialogInitStartIcon #fIcon
Ds0 f61 expr out #txt
Ds0 f61 31 150 89 196 #arcP
Ds0 f62 guid 11E26530B3EFE0DB #txt
Ds0 f62 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f62 method setTableVisible(Boolean) #txt
Ds0 f62 disableUIEvents false #txt
Ds0 f62 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Boolean visible> param = methodEvent.getInputArguments();
' #txt
Ds0 f62 inParameterMapAction 'out.tableVisible=param.visible;
' #txt
Ds0 f62 outParameterDecl '<> result;
' #txt
Ds0 f62 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setTableVisible(Boolean)</name>
        <nameStyle>24,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f62 1102 206 20 20 -49 -33 #rect
Ds0 f62 @|RichDialogMethodStartIcon #fIcon
Ds0 f63 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f63 1099 267 26 26 14 0 #rect
Ds0 f63 @|RichDialogProcessEndIcon #fIcon
Ds0 f64 expr out #txt
Ds0 f64 1112 226 1112 267 #arcP
Ds0 f65 guid 11E2653B73A762C3 #txt
Ds0 f65 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f65 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f65 actionTable 'out=in;
' #txt
Ds0 f65 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>remove selected Files from edition</name>
        <nameStyle>34,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f65 1294 86 20 20 -63 -27 #rect
Ds0 f65 @|RichDialogProcessStartIcon #fIcon
Ds0 f66 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f66 actionTable 'out=in;
' #txt
Ds0 f66 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;

List <FileCouple> filesCouples= new List<FileCouple>();
int j = panel.fileEditedTable.getSelectedListEntries().size();
for(int i=0; i<j; i++){
	filesCouples.add(panel.fileEditedTable.getSelectedListEntries().get(i) as FileCouple);
}
in.editedFileList.removeAll(filesCouples);
panel.fileEditorCheckerPanel.setFileCouplesList(in.editedFileList);
panel.fireUnlockFiles(filesCouples);' #txt
Ds0 f66 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f66 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f66 1286 148 36 24 20 -2 #rect
Ds0 f66 @|RichDialogProcessStepIcon #fIcon
Ds0 f67 expr out #txt
Ds0 f67 1304 106 1304 148 #arcP
Ds0 f68 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f68 1291 211 26 26 14 0 #rect
Ds0 f68 @|RichDialogProcessEndIcon #fIcon
Ds0 f69 expr out #txt
Ds0 f69 1304 172 1304 211 #arcP
Ds0 f70 guid 11E266DD83AC3F4A #txt
Ds0 f70 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f70 method getTableVisible() #txt
Ds0 f70 disableUIEvents false #txt
Ds0 f70 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f70 outParameterDecl '<java.lang.Boolean visible> result;
' #txt
Ds0 f70 outParameterMapAction 'result.visible=in.tableVisible;
' #txt
Ds0 f70 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getTableVisible()</name>
        <nameStyle>17,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f70 1094 638 20 20 -34 -29 #rect
Ds0 f70 @|RichDialogMethodStartIcon #fIcon
Ds0 f71 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f71 1091 691 26 26 14 0 #rect
Ds0 f71 @|RichDialogProcessEndIcon #fIcon
Ds0 f72 expr out #txt
Ds0 f72 1104 658 1104 691 #arcP
Ds0 f75 guid 11E442096AC9C7C0 #txt
Ds0 f75 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f75 method getOSUserName() #txt
Ds0 f75 disableUIEvents false #txt
Ds0 f75 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f75 outParameterDecl '<java.lang.String OSUserName> result;
' #txt
Ds0 f75 outParameterMapAction 'result.OSUserName=in.osUserName;
' #txt
Ds0 f75 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getOSUserName()</name>
        <nameStyle>15,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f75 966 766 20 20 -35 -32 #rect
Ds0 f75 @|RichDialogMethodStartIcon #fIcon
Ds0 f76 guid 11E4420E9E8584FC #txt
Ds0 f76 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f76 method getUserTempDir() #txt
Ds0 f76 disableUIEvents false #txt
Ds0 f76 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f76 outParameterDecl '<java.lang.String userTempDir> result;
' #txt
Ds0 f76 outParameterMapAction 'result.userTempDir=in.clientTempPath;
' #txt
Ds0 f76 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getUserTempDir()</name>
        <nameStyle>16,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f76 1094 766 20 20 -37 -31 #rect
Ds0 f76 @|RichDialogMethodStartIcon #fIcon
Ds0 f77 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f77 actionTable 'out=in;
' #txt
Ds0 f77 actionCode 'if(in.#userPropertiesHandler.getUserName()!=null){
	if(!in.userPropertiesHandler.getUserName().trim().equalsIgnoreCase("")){
		in.osUserName=in.userPropertiesHandler.getUserName();
	}
	else{
		in.osUserName="default User";
	}
}' #txt
Ds0 f77 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f77 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f77 958 828 36 24 20 -2 #rect
Ds0 f77 @|RichDialogProcessStepIcon #fIcon
Ds0 f78 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f78 actionTable 'out=in;
' #txt
Ds0 f78 actionCode 'if(in.#userPropertiesHandler.getUserTempDir()!=null){
	if(!in.userPropertiesHandler.getUserTempDir().trim().equalsIgnoreCase("")){
		in.clientTempPath=in.userPropertiesHandler.getUserTempDir();
	}
	else{
		in.clientTempPath="";
	}
}' #txt
Ds0 f78 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f78 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f78 1086 828 36 24 20 -2 #rect
Ds0 f78 @|RichDialogProcessStepIcon #fIcon
Ds0 f79 expr out #txt
Ds0 f79 1104 786 1104 828 #arcP
Ds0 f80 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f80 1091 899 26 26 14 0 #rect
Ds0 f80 @|RichDialogProcessEndIcon #fIcon
Ds0 f81 expr out #txt
Ds0 f81 1104 852 1104 899 #arcP
Ds0 f82 expr out #txt
Ds0 f82 976 786 976 828 #arcP
Ds0 f83 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f83 963 899 26 26 14 0 #rect
Ds0 f83 @|RichDialogProcessEndIcon #fIcon
Ds0 f84 expr out #txt
Ds0 f84 976 852 976 899 #arcP
Ds0 f85 guid 11E451F87364E245 #txt
Ds0 f85 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f85 method _getUserNameCallBack(String) #txt
Ds0 f85 disableUIEvents false #txt
Ds0 f85 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String username> param = methodEvent.getInputArguments();
' #txt
Ds0 f85 inParameterMapAction 'out.osUserName=param.username;
' #txt
Ds0 f85 outParameterDecl '<> result;
' #txt
Ds0 f85 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_getUserNameCallBack(String)</name>
        <nameStyle>28,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f85 1302 318 20 20 -61 -32 #rect
Ds0 f85 @|RichDialogMethodStartIcon #fIcon
Ds0 f86 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f86 1299 427 26 26 14 0 #rect
Ds0 f86 @|RichDialogProcessEndIcon #fIcon
Ds0 f88 guid 11E451FE94A46377 #txt
Ds0 f88 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f88 method _getUserTempDirCallBack(String) #txt
Ds0 f88 disableUIEvents false #txt
Ds0 f88 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String userTempDir> param = methodEvent.getInputArguments();
' #txt
Ds0 f88 inParameterMapAction 'out.clientTempPath=param.userTempDir;
' #txt
Ds0 f88 outParameterDecl '<> result;
' #txt
Ds0 f88 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_getUserTempDirCallBack(String)</name>
        <nameStyle>31,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f88 1302 518 20 20 -62 -32 #rect
Ds0 f88 @|RichDialogMethodStartIcon #fIcon
Ds0 f89 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f89 1299 587 26 26 14 0 #rect
Ds0 f89 @|RichDialogProcessEndIcon #fIcon
Ds0 f4 expr out #txt
Ds0 f4 104 220 104 267 #arcP
Ds0 f73 actionDecl 'String osUserName;
' #txt
Ds0 f73 actionTable 'osUserName=in.osUserName;
' #txt
Ds0 f73 actionCode panel.fireOsUserNameChanged(osUserName); #txt
Ds0 f73 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f73 fireEvent osUserNameChanged(String) #txt
Ds0 f73 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>osUserNameChanged</name>
        <nameStyle>17,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f73 1294 364 36 24 20 -2 #rect
Ds0 f73 @|RichDialogFireEventIcon #fIcon
Ds0 f74 expr out #txt
Ds0 f74 1312 338 1312 364 #arcP
Ds0 f87 expr out #txt
Ds0 f87 1312 388 1312 427 #arcP
Ds0 f91 actionDecl 'String userTempDir;
' #txt
Ds0 f91 actionTable 'userTempDir=in.clientTempPath;
' #txt
Ds0 f91 actionCode panel.fireUserTemDirChanged(userTempDir); #txt
Ds0 f91 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f91 fireEvent userTemDirChanged(String) #txt
Ds0 f91 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>userTempDirChanged</name>
        <nameStyle>18,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f91 1294 548 36 24 20 -2 #rect
Ds0 f91 @|RichDialogFireEventIcon #fIcon
Ds0 f92 expr out #txt
Ds0 f92 1312 538 1312 548 #arcP
Ds0 f90 expr out #txt
Ds0 f90 1312 572 1312 587 #arcP
Ds0 f93 guid 11E4978B10DDCEE3 #txt
Ds0 f93 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f93 method unLockSelectedDocumentsOnServer(List<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer>) #txt
Ds0 f93 disableUIEvents false #txt
Ds0 f93 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer> listOfFilesToUnlock> param = methodEvent.getInputArguments();
' #txt
Ds0 f93 inParameterMapAction 'out.FilesToUnlock=param.listOfFilesToUnlock;
' #txt
Ds0 f93 outParameterDecl '<> result;
' #txt
Ds0 f93 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>unLockSelectedDocumentsOnServer</name>
        <nameStyle>31,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f93 1462 86 20 20 -65 -30 #rect
Ds0 f93 @|RichDialogMethodStartIcon #fIcon
Ds0 f94 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f94 actionTable 'out=in;
' #txt
Ds0 f94 actionCode 'import ch.ivyteam.ivy.addons.filemanager.database.AbstractFileManagementHandler;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
import ch.ivyteam.ivy.addons.filemanager.DocumentOnServer;
import ch.ivyteam.ivy.addons.filemanager.FileCouple;


List <FileCouple> fcToRemove= new List<FileCouple>();
List <FileCouple> fcStillEdited= new List<FileCouple>();
List<DocumentOnServer> notEditedDocs = new List<DocumentOnServer>(); //this list is used to find the still marked as edited but not really edited anymore
for(DocumentOnServer doc: in.FilesToUnlock)
{
	boolean found = false;
	for(FileCouple fc : in.editedFileList)
	{
		if(AbstractFileManagementHandler.formatPath(fc.serverSidePath).equals(doc.path))
			{
					found=true;
					break;
			}
	}
	if(!found){
		notEditedDocs.add(doc);
	}
}
for(FileCouple fc : in.editedFileList)
{
	boolean found = false;
	for(DocumentOnServer doc: in.FilesToUnlock)
	{
			if(AbstractFileManagementHandler.formatPath(fc.serverSidePath).equals(doc.path))
			{
					found=true;
					fcToRemove.add(fc);
					try
					{
						String s =FileHandler.getFileDirectoryPath(fc.clientFile);
						if(s!=null && s.length()>0){
							in.userTempDirectoryManager.deleteTempDir(s);
						}
					}catch(Throwable t){
						// do nothing
					}
					break;
			}
	}
	if(!found)
	{
		fcStillEdited.add(fc);
	}
}
in.editedFileList.clear();
in.editedFileList.addAll(fcStillEdited);
panel.fileEditorCheckerPanel.setFileCouplesList(in.editedFileList);
panel.fireUnlockFiles(fcToRemove);
if(!notEditedDocs.isEmpty()){
	panel.fireForceDocsUnlock(notEditedDocs);
}' #txt
Ds0 f94 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f94 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Removes the given documents from
the fileCoupleChecking System
Fires unLockFiles@SUBSC
fireForceDocsUnlock@SUBSC</name>
        <nameStyle>33,0,7,9
79,0,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f94 1454 148 36 24 20 -17 #rect
Ds0 f94 @|RichDialogProcessStepIcon #fIcon
Ds0 f94 -5972572|-1|-16777216 #nodeStyle
Ds0 f95 expr out #txt
Ds0 f95 1472 106 1472 148 #arcP
Ds0 f96 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f96 1459 251 26 26 14 0 #rect
Ds0 f96 @|RichDialogProcessEndIcon #fIcon
Ds0 f97 expr out #txt
Ds0 f97 1472 172 1472 251 #arcP
Ds0 f98 guid 11E498BA948EAA2A #txt
Ds0 f98 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f98 method forceUnlock(List<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer>) #txt
Ds0 f98 disableUIEvents false #txt
Ds0 f98 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer> listOfDoumentsonServer> param = methodEvent.getInputArguments();
' #txt
Ds0 f98 inParameterMapAction 'out.FilesToUnlock=param.listOfDoumentsonServer;
' #txt
Ds0 f98 outParameterDecl '<> result;
' #txt
Ds0 f98 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>forceUnlock(List&lt;DocumentOnServer&gt;)</name>
        <nameStyle>35,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f98 1718 86 20 20 -40 -27 #rect
Ds0 f98 @|RichDialogMethodStartIcon #fIcon
Ds0 f99 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f99 actionTable 'out=in;
' #txt
Ds0 f99 actionCode 'import ch.ivyteam.ivy.addons.filemanager.DocumentOnServer;
import ch.ivyteam.ivy.addons.filemanager.FileCouple;

List <FileCouple> filesCouples= new List<FileCouple>();
for(DocumentOnServer doc: in.FilesToUnlock){
	
		java.io.File f = new java.io.File(doc.path);
		FileCouple fc = new FileCouple();
		fc.serverFile=f;
		filesCouples.add(fc);
	
}
for(FileCouple fc: filesCouples){
	for(FileCouple fc2 : in.editedFileList){
		if(fc.serverFile.getPath().equals(fc2.serverFile.getPath())){
			in.editedFileList.remove(fc2);
			break;
		}
	}
}
panel.fileEditorCheckerPanel.setFileCouplesList(in.editedFileList);
panel.fireUnlockFiles(filesCouples);' #txt
Ds0 f99 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f99 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f99 1710 140 36 24 20 -2 #rect
Ds0 f99 @|RichDialogProcessStepIcon #fIcon
Ds0 f100 expr out #txt
Ds0 f100 1728 106 1728 140 #arcP
Ds0 f101 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f101 1715 251 26 26 14 0 #rect
Ds0 f101 @|RichDialogProcessEndIcon #fIcon
Ds0 f102 expr out #txt
Ds0 f102 1728 164 1728 251 #arcP
Ds0 f103 guid 11E8D0044582C100 #txt
Ds0 f103 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f103 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f103 actionTable 'out=in;
' #txt
Ds0 f103 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.richdialog.exec.RdEvent;

RdEvent e = event as RdEvent;
if(e.getParameter() instanceof java.io.File){
	panel.fireFileModifiedReported(e.getParameter() as java.io.File);
}else if(e.getParameter() instanceof FileCouple){
	FileCouple fc = e.getParameter() as FileCouple;
	for(FileCouple f: in.editedFileList){
		if(fc.serverSidePath.compareTo(f.serverSidePath)==0){
			if(f.hasChanged){
				ivy.log.debug("File has at least already changed "+fc.getServerSidePath());
				fc.hasChanged=true;
				panel.fireFileCoupleModifiedReported(fc);
			}else{
				panel.fireFileCoupleModifiedReported(fc);
				//f.setHasChanged(true);
				ivy.log.debug("File has just changed "+fc.getServerSidePath());
			}
		}
	}
	
	//ivy.log.info("filecouple changed reported "+fc.getServerSidePath());
	//ivy.log.info("filecouple inner Java File "+(fc.getReferencedDocumentOnServer()!=null && fc.getReferencedDocumentOnServer().getJavaFile()!=null?fc.getReferencedDocumentOnServer().getJavaFile().getPath():"NULL"));
	
}' #txt
Ds0 f103 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>filemodifiedReported</name>
        <nameStyle>20,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f103 1462 334 20 20 -37 -30 #rect
Ds0 f103 @|RichDialogProcessStartIcon #fIcon
Ds0 f104 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f104 1459 395 26 26 14 0 #rect
Ds0 f104 @|RichDialogProcessEndIcon #fIcon
Ds0 f105 expr out #txt
Ds0 f105 1472 354 1472 395 #arcP
Ds0 f106 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>Fires the fileModifiedReported Event @SUBSCRIBERS
if the incoming parameter is a java.io.File
OR
fireFileCoupleModifiedReported Event @SUBSCRIBERS
if the incoming parameter is a ch.ivyteam.ivy.addons.filemanager.FileCouple</name>
        <nameStyle>222,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f106 1531 323 426 90 -208 -40 #rect
Ds0 f106 @|IBIcon #fIcon
Ds0 f106 -985168|-1|-16777216 #nodeStyle
Ds0 f107 guid 11F7F76AA31F2186 #txt
Ds0 f107 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f107 method setUserName(String) #txt
Ds0 f107 disableUIEvents false #txt
Ds0 f107 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String userName> param = methodEvent.getInputArguments();
' #txt
Ds0 f107 inParameterMapAction 'out.osUserName=param.userName;
' #txt
Ds0 f107 outParameterDecl '<> result;
' #txt
Ds0 f107 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setUserName(String)</name>
        <nameStyle>19,5,6,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f107 966 974 20 20 -30 -34 #rect
Ds0 f107 @|RichDialogMethodStartIcon #fIcon
Ds0 f108 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f108 963 1019 26 26 14 0 #rect
Ds0 f108 @|RichDialogProcessEndIcon #fIcon
Ds0 f109 expr out #txt
Ds0 f109 976 994 976 1019 #arcP
Ds0 f110 guid 120C25EF9A6B2E23 #txt
Ds0 f110 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f110 method printFile(java.io.File) #txt
Ds0 f110 disableUIEvents false #txt
Ds0 f110 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f110 inParameterMapAction 'out.fileToWorkWith=param.file;
' #txt
Ds0 f110 outParameterDecl '<> result;
' #txt
Ds0 f110 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>printFile(File)</name>
        <nameStyle>15,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f110 542 278 20 20 -31 -30 #rect
Ds0 f110 @|RichDialogMethodStartIcon #fIcon
Ds0 f111 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f111 actionTable 'out=in;
' #txt
Ds0 f111 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileHandler;
if(!in.userPropertiesHandler.getUserTempDir().trim().equalsIgnoreCase("")){
	in.clientTempPath=in.userPropertiesHandler.getUserTempDir();
}

in.baseTempDir=in.clientTempPath+in.clientApplicationTempDir;
boolean b = false;
if(in.#fileToWorkWith!=null){

	b=FileHandler.download(in.fileToWorkWith,in.baseTempDir);
	if(b){
		java.io.File file = new java.io.File(in.baseTempDir+in.fileToWorkWith.getName());
		if(in.#DesktopHandlerObject!=null){
			in.DesktopHandlerObject.print(file);
	}else{
		in.errorMessage="Could''nt download the file "+in.fileToWorkWith.getPath();
		panel._DesktopException(in.errorMessage);
	}
}
}else{
	in.errorMessage="No file selected";
	panel._DesktopException(in.errorMessage);
}' #txt
Ds0 f111 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f111 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f111 534 324 36 24 20 -2 #rect
Ds0 f111 @|RichDialogProcessStepIcon #fIcon
Ds0 f112 expr out #txt
Ds0 f112 552 298 552 324 #arcP
Ds0 f113 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f113 539 379 26 26 14 0 #rect
Ds0 f113 @|RichDialogProcessEndIcon #fIcon
Ds0 f114 expr out #txt
Ds0 f114 552 348 552 379 #arcP
Ds0 f116 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f116 actionTable 'out=in;
' #txt
Ds0 f116 actionCode 'for(java.io.File f: in.filesToWorkWith){
	panel.editFile(f);
}' #txt
Ds0 f116 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f116 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f116 398 636 36 24 20 -2 #rect
Ds0 f116 @|RichDialogProcessStepIcon #fIcon
Ds0 f118 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f118 406 686 20 20 13 0 #rect
Ds0 f118 @|RichDialogProcessEndIcon #fIcon
Ds0 f119 expr out #txt
Ds0 f119 416 660 416 686 #arcP
Ds0 f121 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f121 actionTable 'out=in;
' #txt
Ds0 f121 actionCode 'for(java.io.File f: in.filesToWorkWith){
	panel.printFile(f);
}' #txt
Ds0 f121 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f121 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f121 470 684 36 24 20 -2 #rect
Ds0 f121 @|RichDialogProcessStepIcon #fIcon
Ds0 f123 expr out #txt
Ds0 f123 470 696 426 696 #arcP
Ds0 f124 guid 1242429CF98236D6 #txt
Ds0 f124 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f124 method editFiles(List<java.io.File>) #txt
Ds0 f124 disableUIEvents false #txt
Ds0 f124 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<java.io.File> files> param = methodEvent.getInputArguments();
' #txt
Ds0 f124 inParameterMapAction 'out.filesToWorkWith=param.files;
' #txt
Ds0 f124 outParameterDecl '<> result;
' #txt
Ds0 f124 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>editFiles(List&lt;File&gt;)</name>
        <nameStyle>21,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f124 406 566 20 20 -21 -30 #rect
Ds0 f124 @|RichDialogMethodStartIcon #fIcon
Ds0 f115 expr out #txt
Ds0 f115 416 586 416 636 #arcP
Ds0 f117 guid 124242A24219071A #txt
Ds0 f117 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f117 method printFiles(List<java.io.File>) #txt
Ds0 f117 disableUIEvents false #txt
Ds0 f117 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<List<java.io.File> files> param = methodEvent.getInputArguments();
' #txt
Ds0 f117 inParameterMapAction 'out.filesToWorkWith=param.files;
' #txt
Ds0 f117 outParameterDecl '<> result;
' #txt
Ds0 f117 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>printFiles(List&lt;File&gt;)</name>
        <nameStyle>22,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f117 478 598 20 20 -52 -32 #rect
Ds0 f117 @|RichDialogMethodStartIcon #fIcon
Ds0 f120 expr out #txt
Ds0 f120 488 618 488 684 #arcP
Ds0 f122 guid 12451D3D1FE937EA #txt
Ds0 f122 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f122 method _newTempDirCreated(String) #txt
Ds0 f122 disableUIEvents false #txt
Ds0 f122 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String tempDirPath> param = methodEvent.getInputArguments();
' #txt
Ds0 f122 inParameterMapAction 'out.lastCreatedTempDir=param.tempDirPath;
' #txt
Ds0 f122 inActionCode '

' #txt
Ds0 f122 outParameterDecl '<> result;
' #txt
Ds0 f122 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_newTempDirCreated(String)</name>
        <nameStyle>26,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f122 1590 462 20 20 13 0 #rect
Ds0 f122 @|RichDialogMethodStartIcon #fIcon
Ds0 f132 guid 12456E720A4E0F04 #txt
Ds0 f132 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f132 method mail(String,List<String>,List<String>,List<String>,String,List<java.io.File>) #txt
Ds0 f132 disableUIEvents false #txt
Ds0 f132 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String subject,List<java.lang.String> to,List<java.lang.String> cc,List<java.lang.String> bcc,java.lang.String body,List<java.io.File> attachments> param = methodEvent.getInputArguments();
' #txt
Ds0 f132 inActionCode 'if(param.#subject!=null){
	out.emailContainer.subject= param.subject;
}else{out.emailContainer.subject="";}

if(param.#body!=null){
	out.emailContainer.body= param.body;
}else{out.emailContainer.body="";}

if(param.to.isEmpty()){out.emailContainer.to.clear();}
else{
	out.emailContainer.to=param.to;
}

if(param.cc.isEmpty()){out.emailContainer.cc.clear();}
else{
	out.emailContainer.cc=param.cc;
}

if(param.bcc.isEmpty()){out.emailContainer.bcc.clear();}
else{
	out.emailContainer.bcc=param.bcc;
}

if(param.attachments.isEmpty()){out.emailContainer.attachments.clear();}
else{
	out.emailContainer.attachments=param.attachments;
}
' #txt
Ds0 f132 outParameterDecl '<> result;
' #txt
Ds0 f132 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>mail(String,List&lt;String&gt;,List&lt;String&gt;,List&lt;String&gt;,String,List&lt;File&gt;)</name>
        <nameStyle>69,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f132 294 814 20 20 -101 -32 #rect
Ds0 f132 @|RichDialogMethodStartIcon #fIcon
Ds0 f133 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f133 actionTable 'out=in;
' #txt
Ds0 f133 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileHandler;
in.attachments="";
for(java.io.File f : in.emailContainer.attachments){
	if(f.exists()){
		boolean b = false;
		b=FileHandler.download(f,in.clientTempPath);
		if(b){
			in.attachments+=in.clientTempPath+f.getName()+";";
		}
	}
}' #txt
Ds0 f133 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f133 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>download the list of attachements</name>
        <nameStyle>33,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f133 286 860 36 24 20 -2 #rect
Ds0 f133 @|RichDialogProcessStepIcon #fIcon
Ds0 f134 expr out #txt
Ds0 f134 304 834 304 860 #arcP
Ds0 f135 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f135 actionTable 'out=in;
' #txt
Ds0 f135 actionCode 'String to="";
String cc="";
String bcc="";

for(String s: in.emailContainer.to){
	to+=s+";";
}
for(String s: in.emailContainer.cc){
	cc+=s+";";
}
for(String s: in.emailContainer.bcc){
	bcc+=s+";";
}

in.DesktopHandlerObject.mailMessage(in.emailContainer.subject,
			in.emailContainer.body,
			to,
			cc,
			bcc,
			in.attachments);' #txt
Ds0 f135 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f135 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f135 286 916 36 24 20 -2 #rect
Ds0 f135 @|RichDialogProcessStepIcon #fIcon
Ds0 f136 expr out #txt
Ds0 f136 304 884 304 916 #arcP
Ds0 f137 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f137 294 966 20 20 13 0 #rect
Ds0 f137 @|RichDialogProcessEndIcon #fIcon
Ds0 f138 expr out #txt
Ds0 f138 304 940 304 966 #arcP
Ds0 f139 guid 12457C101E93E026 #txt
Ds0 f139 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f139 method mail(ch.ivyteam.ivy.addons.filemanager.EmailContainer) #txt
Ds0 f139 disableUIEvents false #txt
Ds0 f139 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivyteam.ivy.addons.filemanager.EmailContainer emailContainer> param = methodEvent.getInputArguments();
' #txt
Ds0 f139 inParameterMapAction 'out.emailContainer=param.emailContainer;
' #txt
Ds0 f139 outParameterDecl '<> result;
' #txt
Ds0 f139 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>mail(EmailContainer)</name>
        <nameStyle>20,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f139 374 830 20 20 13 0 #rect
Ds0 f139 @|RichDialogMethodStartIcon #fIcon
Ds0 f140 expr out #txt
Ds0 f140 374 843 322 865 #arcP
Ds0 f142 guid 12470AC9EECD878D #txt
Ds0 f142 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f142 method _callBackIsFileEditable(Boolean) #txt
Ds0 f142 disableUIEvents false #txt
Ds0 f142 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Boolean isFileEditable> param = methodEvent.getInputArguments();
' #txt
Ds0 f142 inParameterMapAction 'out.isFileEditable=param.isFileEditable;
' #txt
Ds0 f142 outParameterDecl '<> result;
' #txt
Ds0 f142 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_callBackIsFileEditable(Boolean)</name>
        <nameStyle>32,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f142 1606 662 20 20 13 0 #rect
Ds0 f142 @|RichDialogMethodStartIcon #fIcon
Ds0 f141 guid 12470AD216A66171 #txt
Ds0 f141 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f141 method _callBackIsFilePrintable(Boolean) #txt
Ds0 f141 disableUIEvents false #txt
Ds0 f141 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.Boolean isFilePrintable> param = methodEvent.getInputArguments();
' #txt
Ds0 f141 inParameterMapAction 'out.isFilePrintable=param.isFilePrintable;
' #txt
Ds0 f141 outParameterDecl '<> result;
' #txt
Ds0 f141 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_callBackIsFilePrintable(Boolean)</name>
        <nameStyle>33,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f141 1830 662 20 20 13 0 #rect
Ds0 f141 @|RichDialogMethodStartIcon #fIcon
Ds0 f143 guid 12470AD2CB42C825 #txt
Ds0 f143 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f143 method isFileEditable(java.io.File) #txt
Ds0 f143 disableUIEvents false #txt
Ds0 f143 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f143 inParameterMapAction 'out.fileToCheckForEdit=param.file;
' #txt
Ds0 f143 outParameterDecl '<> result;
' #txt
Ds0 f143 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>isFileEditable(File)</name>
        <nameStyle>20,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f143 294 1070 20 20 -42 -29 #rect
Ds0 f143 @|RichDialogMethodStartIcon #fIcon
Ds0 f144 guid 12470AD3C741EEB7 #txt
Ds0 f144 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f144 method isFilePrintable(java.io.File) #txt
Ds0 f144 disableUIEvents false #txt
Ds0 f144 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f144 inParameterMapAction 'out.fileToCheckForPrint=param.file;
' #txt
Ds0 f144 outParameterDecl '<> result;
' #txt
Ds0 f144 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>isFilePrintable(File)</name>
        <nameStyle>21,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f144 454 1070 20 20 -41 -30 #rect
Ds0 f144 @|RichDialogMethodStartIcon #fIcon
Ds0 f145 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f145 actionTable 'out=in;
' #txt
Ds0 f145 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
FileCouple fc = new FileCouple();
boolean b = false;
in.baseTempDir=FileHandler.formatPathWithEndSeparator(in.clientTempPath+in.clientApplicationTempDir,false);
if(in.#fileToCheckForEdit!=null){
	b=FileHandler.download(in.fileToCheckForEdit,in.baseTempDir);
	if(b){
		java.io.File file = new java.io.File(in.baseTempDir+in.fileToCheckForEdit.getName());
		in.DesktopHandlerObject.isFileEditable(file);
	}else{
		panel._DesktopException(ivy.cms.co("/ch/ivyteam/ivy/addons/filemanager/DesktopHandler/messages/error/fileDownloadErrorInIsEditableMethod"));
	}
}' #txt
Ds0 f145 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f145 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f145 286 1124 36 24 20 -2 #rect
Ds0 f145 @|RichDialogProcessStepIcon #fIcon
Ds0 f146 expr out #txt
Ds0 f146 304 1090 304 1124 #arcP
Ds0 f147 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f147 actionTable 'out=in;
' #txt
Ds0 f147 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f147 446 1124 36 24 20 -2 #rect
Ds0 f147 @|RichDialogProcessStepIcon #fIcon
Ds0 f148 expr out #txt
Ds0 f148 464 1090 464 1124 #arcP
Ds0 f152 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f152 294 1182 20 20 13 0 #rect
Ds0 f152 @|RichDialogProcessEndIcon #fIcon
Ds0 f153 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f153 454 1182 20 20 13 0 #rect
Ds0 f153 @|RichDialogProcessEndIcon #fIcon
Ds0 f154 expr out #txt
Ds0 f154 464 1148 464 1182 #arcP
Ds0 f155 expr out #txt
Ds0 f155 304 1148 304 1182 #arcP
Ds0 f156 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f156 1606 774 20 20 13 0 #rect
Ds0 f156 @|RichDialogProcessEndIcon #fIcon
Ds0 f158 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f158 1830 774 20 20 13 0 #rect
Ds0 f158 @|RichDialogProcessEndIcon #fIcon
Ds0 f159 expr out #txt
Ds0 f159 1840 682 1840 774 #arcP
Ds0 f160 actionDecl 'Boolean isFileEditable;
' #txt
Ds0 f160 actionTable 'isFileEditable=in.isFileEditable;
' #txt
Ds0 f160 actionCode panel.fireIsFileEditableReported(isFileEditable); #txt
Ds0 f160 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f160 fireEvent isFileEditableReported(Boolean) #txt
Ds0 f160 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>isFileEditableReported@
SUBSCRIBERS</name>
        <nameStyle>35,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f160 1598 716 36 24 21 -11 #rect
Ds0 f160 @|RichDialogFireEventIcon #fIcon
Ds0 f161 expr out #txt
Ds0 f161 1616 682 1616 716 #arcP
Ds0 f157 expr out #txt
Ds0 f157 1616 740 1616 774 #arcP
Ds0 f162 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f162 actionTable 'out=in;
' #txt
Ds0 f162 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
import ch.ivyteam.ivy.addons.filemanager.FileCouple;

FileCouple fc = new FileCouple();
int i=0;
boolean b = false;
boolean found = false;
if(!in.lastCreatedTempDir.trim().equalsIgnoreCase("")){
	
	String s = FileHandler.getFolderNameFromPath(in.lastCreatedTempDir);
	for(FileAndTempDirCouple ftd : in.filesToEdit){
		if(s.equalsIgnoreCase(ftd.tempDirName)){
			java.io.File file = new java.io.File(in.lastCreatedTempDir+ftd.file.getName());
		  b=FileHandler.download(ftd.file,in.lastCreatedTempDir);
			//The file will be edited
			fc.serverFile=ftd.file;
			if(ftd.#documentOnServer!=null){
				fc.serverSidePath = ftd.documentOnServer.path;
				fc.referencedDocumentOnServer = ftd.documentOnServer;
			}else{
				fc.serverSidePath=fc.serverFile.getPath();
			}
			fc.clientFile=file;
			found=true;
			if(in.#DesktopHandlerObject!=null){
				if(b){
					if(ftd.isFileEditable){
						//workaround to pb with files that are not viewed as editable
						in.DesktopHandlerObject.openFile(file);
						in.editedFileList.add(fc);
						panel.fileEditorCheckerPanel.setFileCouplesList(in.editedFileList);
					}else{
						//The file will be opened in read Only mode
						in.DesktopHandlerObject.openFile(file,true);
						in.filesInReading.add(fc);
					}
				}else{
						ivy.log.error("File not downloaded");
					}
				}
			break;	
		}
		i++;
	}
	if(found){
		in.filesToEdit.removeAt(i);
	}
}' #txt
Ds0 f162 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f162 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>use the hashmap to get the
File to edit</name>
        <nameStyle>39,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f162 1582 508 36 24 20 -2 #rect
Ds0 f162 @|RichDialogProcessStepIcon #fIcon
Ds0 f163 expr out #txt
Ds0 f163 1600 482 1600 508 #arcP
Ds0 f128 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f128 1591 558 19 20 13 0 #rect
Ds0 f128 @|RichDialogProcessEndIcon #fIcon
Ds0 f164 expr out #txt
Ds0 f164 1600 532 1599 558 #arcP
Ds0 f165 guid 125F972066FB9D12 #txt
Ds0 f165 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f165 method startWithClientTempDirectory(String) #txt
Ds0 f165 disableUIEvents true #txt
Ds0 f165 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String clientTempDirectory> param = methodEvent.getInputArguments();
' #txt
Ds0 f165 inParameterMapAction 'out.baseTempDir=param.clientTempDirectory;
out.tableVisible=false;
' #txt
Ds0 f165 outParameterDecl '<> result;
' #txt
Ds0 f165 embeddedRdInitializations '{/fileEditorCheckerPanel {/fieldName "fileEditorCheckerPanel"/startMethod "start()"/parameterMapping ""/initScript ""}}' #txt
Ds0 f165 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>startWithClientTempDirectory(String)</name>
        <nameStyle>36,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f165 94 70 20 20 -76 -31 #rect
Ds0 f165 @|RichDialogInitStartIcon #fIcon
Ds0 f166 expr out #txt
Ds0 f166 104 90 104 196 #arcP
Ds0 f167 guid 125F9B74E2AFE84B #txt
Ds0 f167 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f167 method getClientApplicationTempDir() #txt
Ds0 f167 disableUIEvents false #txt
Ds0 f167 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f167 outParameterDecl '<java.lang.String clientApplicationTempDir> result;
' #txt
Ds0 f167 outParameterMapAction 'result.clientApplicationTempDir=in.clientApplicationTempDir;
' #txt
Ds0 f167 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getClientApplicationTempDir()</name>
        <nameStyle>29,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f167 966 1086 20 20 13 0 #rect
Ds0 f167 @|RichDialogMethodStartIcon #fIcon
Ds0 f168 guid 125F9B75E38FE206 #txt
Ds0 f168 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f168 method setClientApplicationTempDir(String) #txt
Ds0 f168 disableUIEvents false #txt
Ds0 f168 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setClientApplicationTempDir(String)</name>
    </language>
</elementInfo>
' #txt
Ds0 f168 966 1174 20 20 13 0 #rect
Ds0 f168 @|RichDialogMethodStartIcon #fIcon
Ds0 f169 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f169 966 1134 20 20 13 0 #rect
Ds0 f169 @|RichDialogProcessEndIcon #fIcon
Ds0 f170 expr out #txt
Ds0 f170 976 1106 976 1134 #arcP
Ds0 f171 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f171 actionTable 'out=in;
' #txt
Ds0 f171 actionCode '//Make the client temp dir if indicated
import ch.ivyteam.ivy.addons.filemanager.FileHandler;
if(in.clientApplicationTempDir.trim().length()>0){
	in.clientApplicationTempDir=FileHandler.formatPathWithEndSeparator(in.clientApplicationTempDir,false);
}
import ch.ivyteam.ivy.addons.filemanager.ulcextensionhandler.UserTempDirectoryManager;
in.userTempDirectoryManager = new UserTempDirectoryManager(in.clientApplicationTempDir,panel,"_newTempDirCreated","_DesktopException");' #txt
Ds0 f171 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f171 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f171 958 1220 36 24 20 -2 #rect
Ds0 f171 @|RichDialogProcessStepIcon #fIcon
Ds0 f172 expr out #txt
Ds0 f172 976 1194 976 1220 #arcP
Ds0 f173 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f173 966 1270 20 20 13 0 #rect
Ds0 f173 @|RichDialogProcessEndIcon #fIcon
Ds0 f174 expr out #txt
Ds0 f174 976 1244 976 1270 #arcP
Ds0 f175 guid 126AC1E262850A49 #txt
Ds0 f175 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f175 method openFileAndCheckForChanges(java.io.File) #txt
Ds0 f175 disableUIEvents false #txt
Ds0 f175 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.io.File file> param = methodEvent.getInputArguments();
' #txt
Ds0 f175 inParameterMapAction 'out.fileToWorkWith=param.file;
' #txt
Ds0 f175 outParameterDecl '<> result;
' #txt
Ds0 f175 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openFileAndCheckForChanges(File)</name>
        <nameStyle>32,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f175 542 110 20 20 -63 -27 #rect
Ds0 f175 @|RichDialogMethodStartIcon #fIcon
Ds0 f176 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f176 actionTable 'out=in;
' #txt
Ds0 f176 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;

boolean b = false;
boolean alreadyOpened=false;
if(in.#fileToWorkWith!=null){
	for(FileCouple f: in.editedFileList){
		//we found that this file is currently edited
		if(f.getServerFile().getPath().equals(in.fileToWorkWith.getPath())){
			alreadyOpened = true;
			//we open the file where she is
			if(in.#DesktopHandlerObject!=null){
				in.DesktopHandlerObject.openFile(f.clientFile);
			}
			if(alreadyOpened){
				break;
			}
		}
	}
	if(!alreadyOpened){
		// if not already opened, we make the unique temp dir for it
		// the temp dir manager will inform the RDPanel as soon as the temp dir was created,
		// we will then edit the file
		String s= System.nanoTime().toString();
		FileAndTempDirCouple ftd = new FileAndTempDirCouple();
		ftd.file = in.fileToWorkWith;
		ftd.tempDirName = s;
		ftd.isFileEditable = false;
		in.filesToEdit.add(ftd);
		in.userTempDirectoryManager.makeTempDir(s);
		
	}
}' #txt
Ds0 f176 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f176 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f176 534 156 36 24 20 -2 #rect
Ds0 f176 @|RichDialogProcessStepIcon #fIcon
Ds0 f177 expr out #txt
Ds0 f177 552 130 552 156 #arcP
Ds0 f178 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f178 542 222 20 20 13 0 #rect
Ds0 f178 @|RichDialogProcessEndIcon #fIcon
Ds0 f179 expr out #txt
Ds0 f179 552 180 552 222 #arcP
Ds0 f180 guid 12784AD53A052E0C #txt
Ds0 f180 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f180 method openBrowser(String) #txt
Ds0 f180 disableUIEvents false #txt
Ds0 f180 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String www> param = methodEvent.getInputArguments();
' #txt
Ds0 f180 inParameterMapAction 'out.www=param.www;
' #txt
Ds0 f180 outParameterDecl '<> result;
' #txt
Ds0 f180 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openBrowser(String)</name>
        <nameStyle>19,5,7,9
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f180 294 1238 20 20 13 0 #rect
Ds0 f180 @|RichDialogMethodStartIcon #fIcon
Ds0 f183 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f183 actionTable 'out=in;
' #txt
Ds0 f183 actionCode in.DesktopHandlerObject.browse(in.www); #txt
Ds0 f183 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f183 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language/>
</elementInfo>
' #txt
Ds0 f183 286 1332 36 24 20 -2 #rect
Ds0 f183 @|RichDialogProcessStepIcon #fIcon
Ds0 f185 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f185 294 1382 20 20 13 0 #rect
Ds0 f185 @|RichDialogProcessEndIcon #fIcon
Ds0 f186 expr out #txt
Ds0 f186 304 1356 304 1382 #arcP
Ds0 f187 expr out #txt
Ds0 f187 304 1258 304 1332 #arcP
Ds0 f125 guid 12E5145D2E125DBE #txt
Ds0 f125 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f125 method _getClientFileSeparatorCallBack(String) #txt
Ds0 f125 disableUIEvents false #txt
Ds0 f125 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<java.lang.String clientFileSeparator> param = methodEvent.getInputArguments();
' #txt
Ds0 f125 inParameterMapAction 'out.clientFileSeparator=param.clientFileSeparator;
' #txt
Ds0 f125 outParameterDecl '<> result;
' #txt
Ds0 f125 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>_getClientFileSeparatorCallBack(String)</name>
        <nameStyle>39,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f125 1302 662 20 20 13 0 #rect
Ds0 f125 @|RichDialogMethodStartIcon #fIcon
Ds0 f126 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f126 actionTable 'out=in;
' #txt
Ds0 f126 actionCode 'panel.fileEditorCheckerPanel.setClientFileSeparator(in.clientFileSeparator);
in.DesktopHandlerObject.setClientFileSeparator(in.clientFileSeparator);' #txt
Ds0 f126 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f126 1294 708 36 24 20 -2 #rect
Ds0 f126 @|RichDialogProcessStepIcon #fIcon
Ds0 f127 expr out #txt
Ds0 f127 1312 682 1312 708 #arcP
Ds0 f129 actionDecl 'String clientFileSparator;
' #txt
Ds0 f129 actionTable 'clientFileSparator=in.clientFileSeparator;
' #txt
Ds0 f129 actionCode panel.fireClientFileSeparatorChanged(clientFileSparator); #txt
Ds0 f129 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f129 fireEvent clientFileSeparatorChanged(String) #txt
Ds0 f129 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>clientFileSeparatorChanged@SUBSC</name>
        <nameStyle>32,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f129 1294 764 36 24 20 -3 #rect
Ds0 f129 @|RichDialogFireEventIcon #fIcon
Ds0 f130 expr out #txt
Ds0 f130 1312 732 1312 764 #arcP
Ds0 f131 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f131 1302 822 20 20 13 0 #rect
Ds0 f131 @|RichDialogProcessEndIcon #fIcon
Ds0 f181 expr out #txt
Ds0 f181 1312 788 1312 822 #arcP
Ds0 f182 guid 1300C71DF9C90201 #txt
Ds0 f182 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f182 method openDocumentOnServerAndCheckForChanges(ch.ivyteam.ivy.addons.filemanager.DocumentOnServer) #txt
Ds0 f182 disableUIEvents false #txt
Ds0 f182 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer documentOnServer> param = methodEvent.getInputArguments();
' #txt
Ds0 f182 inParameterMapAction 'out.documentOnServerToWorkWith=param.documentOnServer;
' #txt
Ds0 f182 outParameterDecl '<> result;
' #txt
Ds0 f182 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openDocumentOnServer
AndCheckForChanges
(DocumentOnServer)</name>
        <nameStyle>58,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f182 726 102 20 20 20 -24 #rect
Ds0 f182 @|RichDialogMethodStartIcon #fIcon
Ds0 f182 -613726|-613726|-16777216 #nodeStyle
Ds0 f184 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f184 actionTable 'out=in;
' #txt
Ds0 f184 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;

FileCouple fc = new FileCouple();
boolean b = false;
boolean alreadyOpened=false;

if(in.#documentOnServerToWorkWith!=null && 
	(
		(in.#documentOnServerToWorkWith.#ivyFile!=null && in.documentOnServerToWorkWith.ivyFile.exists()) || 
		(in.#documentOnServerToWorkWith.#javaFile!=null && in.documentOnServerToWorkWith.javaFile.isFile())
	))
	{
	if(in.#documentOnServerToWorkWith.#javaFile!=null)
	{// if the java File is not null it means that we work with a physically stored file
		for(FileCouple f: in.editedFileList){
			//we found that this file is currently edited
			if(f.serverSidePath.equals(in.documentOnServerToWorkWith.path)){
				alreadyOpened = true;
				//we open the file where she is
				if(in.#DesktopHandlerObject!=null){
					in.DesktopHandlerObject.openFile(f.clientFile);
				}
				if(alreadyOpened){
					break;
				}
			}
		}
	}
	else
	{// we certainly work with files stored in DB => for the duration of the edition these files are transformed as non persistent ivy files.
		for(FileCouple f: in.editedFileList){
			//we found that this file is currently edited
			if(f.serverSidePath.equals(in.documentOnServerToWorkWith.path)){
				alreadyOpened = true;
				//we open the file where she is
				if(in.#DesktopHandlerObject!=null){
					in.DesktopHandlerObject.openFile(f.clientFile);
				}
				if(alreadyOpened){
					break;
				}
			}
		}
	}
	
	if(!alreadyOpened){
		// if not already opened, we make the unique temp dir for it
		// the temp dir manager will inform the RDPanel as soon as the temp dir was created,
		// we will then edit the file
		String s= System.nanoTime().toString();
		FileAndTempDirCouple ftd = new FileAndTempDirCouple();
		
		if(in.#documentOnServerToWorkWith.#javaFile!=null)
		{// if the java File is not null it means that we work with a physically stored file
			ftd.file = in.documentOnServerToWorkWith.javaFile;
		}else
		{// we certainly work with files stored in DB => for the duration of the edition these files are transformed as non persistent ivy files.
			ftd.file = in.documentOnServerToWorkWith.ivyFile.getJavaFile();
		}
		in.documentOnServerToWorkWith.locked="1";
		in.documentOnServerToWorkWith.lockingUserID=ivy.session.getSessionUserName();
		ftd.documentOnServer = in.documentOnServerToWorkWith.clone();
		ftd.tempDirName = s;
		ftd.isFileEditable = true;
		in.filesToEdit.add(ftd);
		in.userTempDirectoryManager.makeTempDir(s);
		
	}
	
}' #txt
Ds0 f184 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f184 718 156 36 24 20 -2 #rect
Ds0 f184 @|RichDialogProcessStepIcon #fIcon
Ds0 f184 -613726|-613726|-16777216 #nodeStyle
Ds0 f188 expr out #txt
Ds0 f188 736 122 736 156 #arcP
Ds0 f189 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f189 726 214 20 20 13 0 #rect
Ds0 f189 @|RichDialogProcessEndIcon #fIcon
Ds0 f189 -613726|-613726|-16777216 #nodeStyle
Ds0 f190 expr out #txt
Ds0 f190 736 180 736 214 #arcP
Ds0 f191 guid 13020E29F2FD9AB9 #txt
Ds0 f191 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f191 method printDocumentOnServer(ch.ivyteam.ivy.addons.filemanager.DocumentOnServer) #txt
Ds0 f191 disableUIEvents false #txt
Ds0 f191 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer documentOnServer> param = methodEvent.getInputArguments();
' #txt
Ds0 f191 inParameterMapAction 'out.documentOnServerToWorkWith=param.documentOnServer;
' #txt
Ds0 f191 outParameterDecl '<> result;
' #txt
Ds0 f191 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>printDocumentOnServer
(DocumentOnServer)</name>
        <nameStyle>40,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f191 726 278 20 20 13 0 #rect
Ds0 f191 @|RichDialogMethodStartIcon #fIcon
Ds0 f191 -613726|-613726|-16777216 #nodeStyle
Ds0 f192 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f192 actionTable 'out=in;
' #txt
Ds0 f192 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileHandler;
if(!in.userPropertiesHandler.getUserTempDir().trim().equalsIgnoreCase("")){
	in.clientTempPath=in.userPropertiesHandler.getUserTempDir();
}

in.baseTempDir=in.clientTempPath+in.clientApplicationTempDir;
boolean b = false;
if(in.#documentOnServerToWorkWith!=null){
	java.io.File f = null;
	if(in.#documentOnServerToWorkWith.#javaFile!=null){
		f= in.documentOnServerToWorkWith.javaFile;
	}else if(in.#documentOnServerToWorkWith.#ivyFile !=null){
		f=in.documentOnServerToWorkWith.ivyFile.getJavaFile();
	}
	if(f!=null){
		b=FileHandler.download(f,in.baseTempDir);
		if(b){
			java.io.File file = new java.io.File(in.baseTempDir+f.getName());
			if(in.#DesktopHandlerObject!=null){
				in.DesktopHandlerObject.print(file);
		}else{
			in.errorMessage="Could''nt download the file "+f.getPath();
			panel._DesktopException(in.errorMessage);
		}
	}else{
		in.errorMessage="No File could be found in the documentOnServer object.";
		panel._DesktopException(in.errorMessage);
	}
}
}else{
	in.errorMessage="No documentOnServer selected";
	panel._DesktopException(in.errorMessage);
}' #txt
Ds0 f192 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f192 718 324 36 24 20 -2 #rect
Ds0 f192 @|RichDialogProcessStepIcon #fIcon
Ds0 f192 -613726|-613726|-16777216 #nodeStyle
Ds0 f193 expr out #txt
Ds0 f193 736 298 736 324 #arcP
Ds0 f194 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f194 726 374 20 20 13 0 #rect
Ds0 f194 @|RichDialogProcessEndIcon #fIcon
Ds0 f195 expr out #txt
Ds0 f195 736 348 736 374 #arcP
Ds0 f196 1531 368 1481 347 #arcP
Ds0 f197 guid 13E4281C7637EFA5 #txt
Ds0 f197 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f197 method openDocumentOnServerReadOnly(ch.ivyteam.ivy.addons.filemanager.DocumentOnServer) #txt
Ds0 f197 disableUIEvents false #txt
Ds0 f197 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivyteam.ivy.addons.filemanager.DocumentOnServer documentOnServer> param = methodEvent.getInputArguments();
' #txt
Ds0 f197 inParameterMapAction 'out.documentOnServerToWorkWith=param.documentOnServer;
' #txt
Ds0 f197 outParameterDecl '<> result;
' #txt
Ds0 f197 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>openDocumentOnServerReadOnly(DocumentOnServer)</name>
        <nameStyle>46,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f197 726 446 20 20 -149 -28 #rect
Ds0 f197 @|RichDialogMethodStartIcon #fIcon
Ds0 f198 actionDecl 'ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData out;
' #txt
Ds0 f198 actionTable 'out=in;
' #txt
Ds0 f198 actionCode 'import ch.ivyteam.ivy.addons.filemanager.FileCouple;
import ch.ivyteam.ivy.addons.filemanager.FileAndTempDirCouple;
import ch.ivyteam.ivy.addons.filemanager.FileHandler;

FileCouple fc = new FileCouple();
boolean b = false;
boolean alreadyOpened=false;

if(in.#documentOnServerToWorkWith!=null && 
	(
		(in.#documentOnServerToWorkWith.#ivyFile!=null && in.documentOnServerToWorkWith.ivyFile.exists()) || 
		(in.#documentOnServerToWorkWith.#javaFile!=null && in.documentOnServerToWorkWith.javaFile.isFile())
	))
	{
	if(in.#documentOnServerToWorkWith.#javaFile!=null)
	{// if the java File is not null it means that we work with a physically stored file
		for(FileCouple f: in.editedFileList){
			//we found that this file is currently edited
			if(f.serverSidePath.equals(in.documentOnServerToWorkWith.path)){
				alreadyOpened = true;
				//we open the file where she is
				if(in.#DesktopHandlerObject!=null){
					in.DesktopHandlerObject.openFile(f.clientFile, true);
				}
				if(alreadyOpened){
					break;
				}
			}
		}
	}
	else
	{// we certainly work with files stored in DB => for the duration of the edition these files are transformed as non persistent ivy files.
		for(FileCouple f: in.editedFileList){
			//we found that this file is currently edited
			if(f.serverSidePath.equals(in.documentOnServerToWorkWith.path)){
				alreadyOpened = true;
				//we open the file where she is
				if(in.#DesktopHandlerObject!=null){
					in.DesktopHandlerObject.openFile(f.clientFile, true);
				}
				if(alreadyOpened){
					break;
				}
			}
		}
	}
	
	if(!alreadyOpened){
		// if not already opened, we make the unique temp dir for it
		// the temp dir manager will inform the RDPanel as soon as the temp dir was created,
		// we will then edit the file
		String s= System.nanoTime().toString();
		FileAndTempDirCouple ftd = new FileAndTempDirCouple();
		
		if(in.#documentOnServerToWorkWith.#javaFile!=null)
		{// if the java File is not null it means that we work with a physically stored file
			ftd.file = in.documentOnServerToWorkWith.javaFile;
		}else
		{// we certainly work with files stored in DB => for the duration of the edition these files are transformed as non persistent ivy files.
			ftd.file = in.documentOnServerToWorkWith.ivyFile.getJavaFile();
		}
		ftd.documentOnServer = in.documentOnServerToWorkWith.clone();
		ftd.tempDirName = s;
		ftd.isFileEditable = false;
		in.filesToEdit.add(ftd);
		in.userTempDirectoryManager.makeTempDir(s);
		
	}
	
}' #txt
Ds0 f198 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f198 718 508 36 24 20 -2 #rect
Ds0 f198 @|RichDialogProcessStepIcon #fIcon
Ds0 f199 expr out #txt
Ds0 f199 736 466 736 508 #arcP
Ds0 f200 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f200 726 574 20 20 13 0 #rect
Ds0 f200 @|RichDialogProcessEndIcon #fIcon
Ds0 f201 expr out #txt
Ds0 f201 736 532 736 574 #arcP
Ds0 f202 guid 13F4315678A65E0F #txt
Ds0 f202 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f202 method getClientDesktopCommunicator() #txt
Ds0 f202 disableUIEvents false #txt
Ds0 f202 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<> param = methodEvent.getInputArguments();
' #txt
Ds0 f202 outParameterDecl '<ch.ivyteam.ivy.addons.filemanager.ulcextensionhandler.DesktopHandler clientDesktopCommunicator> result;
' #txt
Ds0 f202 outParameterMapAction 'result.clientDesktopCommunicator=in.DesktopHandlerObject;
' #txt
Ds0 f202 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>getClientDesktopCommunicator()</name>
        <nameStyle>30,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f202 2006 214 20 20 13 0 #rect
Ds0 f202 @|RichDialogMethodStartIcon #fIcon
Ds0 f203 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f203 2006 278 20 20 13 0 #rect
Ds0 f203 @|RichDialogProcessEndIcon #fIcon
Ds0 f204 expr out #txt
Ds0 f204 2016 234 2016 278 #arcP
Ds0 f149 guid 140BA56DC1A6DA86 #txt
Ds0 f149 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f149 method setDocumentFilter(ch.ivyteam.ivy.addons.filemanager.database.security.DocumentFilter) #txt
Ds0 f149 disableUIEvents false #txt
Ds0 f149 inParameterDecl 'ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent methodEvent = event as ch.ivyteam.ivy.richdialog.exec.RdMethodCallEvent;
<ch.ivyteam.ivy.addons.filemanager.database.security.DocumentFilter documentFilter> param = methodEvent.getInputArguments();
' #txt
Ds0 f149 inParameterMapAction 'out.documentFilter=param.documentFilter;
' #txt
Ds0 f149 outParameterDecl '<> result;
' #txt
Ds0 f149 @C|.xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <name>setDocumentFilter(DocumentFilter)</name>
        <nameStyle>33,5,7
</nameStyle>
    </language>
</elementInfo>
' #txt
Ds0 f149 726 662 20 20 13 0 #rect
Ds0 f149 @|RichDialogMethodStartIcon #fIcon
Ds0 f150 type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
Ds0 f150 726 726 20 20 13 0 #rect
Ds0 f150 @|RichDialogProcessEndIcon #fIcon
Ds0 f151 expr out #txt
Ds0 f151 736 682 736 726 #arcP
>Proto Ds0 .rdData2UIAction 'panel.fileEditedTable.listData=in.editedFileList;
panel.visible=in.tableVisible;
' #txt
>Proto Ds0 .type ch.ivyteam.ivy.addons.filemanager.DesktopHandler.DesktopHandlerData #txt
>Proto Ds0 .processKind RICH_DIALOG #txt
>Proto Ds0 .xml '<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<elementInfo>
    <language>
        <swimlaneLabel>Start and exception</swimlaneLabel>
        <swimlaneLabel>action methods</swimlaneLabel>
        <swimlaneLabel>getter and setter</swimlaneLabel>
        <swimlaneLabel></swimlaneLabel>
    </language>
    <swimlaneSize>240</swimlaneSize>
    <swimlaneSize>656</swimlaneSize>
    <swimlaneSize>295</swimlaneSize>
    <swimlaneColor>-26266</swimlaneColor>
    <swimlaneColor>-1</swimlaneColor>
    <swimlaneColor>-6710785</swimlaneColor>
</elementInfo>
' #txt
>Proto Ds0 -8 -8 16 16 16 26 #rect
>Proto Ds0 '' #fIcon
Ds0 f0 mainOut f3 tail #connect
Ds0 f3 head f2 mainIn #connect
Ds0 f5 mainOut f7 tail #connect
Ds0 f7 head f6 mainIn #connect
Ds0 f6 mainOut f9 tail #connect
Ds0 f9 head f8 mainIn #connect
Ds0 f10 mainOut f12 tail #connect
Ds0 f12 head f11 mainIn #connect
Ds0 f11 mainOut f14 tail #connect
Ds0 f14 head f13 mainIn #connect
Ds0 f18 mainOut f20 tail #connect
Ds0 f20 head f19 mainIn #connect
Ds0 f19 mainOut f22 tail #connect
Ds0 f22 head f21 mainIn #connect
Ds0 f23 mainOut f25 tail #connect
Ds0 f25 head f24 mainIn #connect
Ds0 f24 mainOut f27 tail #connect
Ds0 f27 head f26 mainIn #connect
Ds0 f29 mainOut f31 tail #connect
Ds0 f31 head f30 mainIn #connect
Ds0 f28 mainOut f32 tail #connect
Ds0 f32 head f29 mainIn #connect
Ds0 f15 mainOut f34 tail #connect
Ds0 f34 head f33 mainIn #connect
Ds0 f16 mainOut f36 tail #connect
Ds0 f36 head f35 mainIn #connect
Ds0 f17 mainOut f38 tail #connect
Ds0 f38 head f37 mainIn #connect
Ds0 f39 mainOut f41 tail #connect
Ds0 f41 head f40 mainIn #connect
Ds0 f40 mainOut f43 tail #connect
Ds0 f43 head f42 mainIn #connect
Ds0 f44 mainOut f46 tail #connect
Ds0 f46 head f45 mainIn #connect
Ds0 f48 mainOut f50 tail #connect
Ds0 f50 head f49 mainIn #connect
Ds0 f49 mainOut f52 tail #connect
Ds0 f52 head f51 mainIn #connect
Ds0 f47 mainOut f54 tail #connect
Ds0 f54 head f53 mainIn #connect
Ds0 f55 mainOut f57 tail #connect
Ds0 f57 head f56 mainIn #connect
Ds0 f56 mainOut f59 tail #connect
Ds0 f59 head f58 mainIn #connect
Ds0 f60 mainOut f61 tail #connect
Ds0 f61 head f2 mainIn #connect
Ds0 f62 mainOut f64 tail #connect
Ds0 f64 head f63 mainIn #connect
Ds0 f65 mainOut f67 tail #connect
Ds0 f67 head f66 mainIn #connect
Ds0 f66 mainOut f69 tail #connect
Ds0 f69 head f68 mainIn #connect
Ds0 f70 mainOut f72 tail #connect
Ds0 f72 head f71 mainIn #connect
Ds0 f76 mainOut f79 tail #connect
Ds0 f79 head f78 mainIn #connect
Ds0 f78 mainOut f81 tail #connect
Ds0 f81 head f80 mainIn #connect
Ds0 f75 mainOut f82 tail #connect
Ds0 f82 head f77 mainIn #connect
Ds0 f77 mainOut f84 tail #connect
Ds0 f84 head f83 mainIn #connect
Ds0 f2 mainOut f4 tail #connect
Ds0 f4 head f1 mainIn #connect
Ds0 f85 mainOut f74 tail #connect
Ds0 f74 head f73 mainIn #connect
Ds0 f73 mainOut f87 tail #connect
Ds0 f87 head f86 mainIn #connect
Ds0 f88 mainOut f92 tail #connect
Ds0 f92 head f91 mainIn #connect
Ds0 f91 mainOut f90 tail #connect
Ds0 f90 head f89 mainIn #connect
Ds0 f93 mainOut f95 tail #connect
Ds0 f95 head f94 mainIn #connect
Ds0 f94 mainOut f97 tail #connect
Ds0 f97 head f96 mainIn #connect
Ds0 f98 mainOut f100 tail #connect
Ds0 f100 head f99 mainIn #connect
Ds0 f99 mainOut f102 tail #connect
Ds0 f102 head f101 mainIn #connect
Ds0 f103 mainOut f105 tail #connect
Ds0 f105 head f104 mainIn #connect
Ds0 f107 mainOut f109 tail #connect
Ds0 f109 head f108 mainIn #connect
Ds0 f110 mainOut f112 tail #connect
Ds0 f112 head f111 mainIn #connect
Ds0 f111 mainOut f114 tail #connect
Ds0 f114 head f113 mainIn #connect
Ds0 f116 mainOut f119 tail #connect
Ds0 f119 head f118 mainIn #connect
Ds0 f121 mainOut f123 tail #connect
Ds0 f123 head f118 mainIn #connect
Ds0 f124 mainOut f115 tail #connect
Ds0 f115 head f116 mainIn #connect
Ds0 f117 mainOut f120 tail #connect
Ds0 f120 head f121 mainIn #connect
Ds0 f132 mainOut f134 tail #connect
Ds0 f134 head f133 mainIn #connect
Ds0 f133 mainOut f136 tail #connect
Ds0 f136 head f135 mainIn #connect
Ds0 f135 mainOut f138 tail #connect
Ds0 f138 head f137 mainIn #connect
Ds0 f139 mainOut f140 tail #connect
Ds0 f140 head f133 mainIn #connect
Ds0 f143 mainOut f146 tail #connect
Ds0 f146 head f145 mainIn #connect
Ds0 f144 mainOut f148 tail #connect
Ds0 f148 head f147 mainIn #connect
Ds0 f147 mainOut f154 tail #connect
Ds0 f154 head f153 mainIn #connect
Ds0 f145 mainOut f155 tail #connect
Ds0 f155 head f152 mainIn #connect
Ds0 f141 mainOut f159 tail #connect
Ds0 f159 head f158 mainIn #connect
Ds0 f142 mainOut f161 tail #connect
Ds0 f161 head f160 mainIn #connect
Ds0 f160 mainOut f157 tail #connect
Ds0 f157 head f156 mainIn #connect
Ds0 f122 mainOut f163 tail #connect
Ds0 f163 head f162 mainIn #connect
Ds0 f162 mainOut f164 tail #connect
Ds0 f164 head f128 mainIn #connect
Ds0 f165 mainOut f166 tail #connect
Ds0 f166 head f2 mainIn #connect
Ds0 f167 mainOut f170 tail #connect
Ds0 f170 head f169 mainIn #connect
Ds0 f168 mainOut f172 tail #connect
Ds0 f172 head f171 mainIn #connect
Ds0 f171 mainOut f174 tail #connect
Ds0 f174 head f173 mainIn #connect
Ds0 f175 mainOut f177 tail #connect
Ds0 f177 head f176 mainIn #connect
Ds0 f176 mainOut f179 tail #connect
Ds0 f179 head f178 mainIn #connect
Ds0 f183 mainOut f186 tail #connect
Ds0 f186 head f185 mainIn #connect
Ds0 f180 mainOut f187 tail #connect
Ds0 f187 head f183 mainIn #connect
Ds0 f125 mainOut f127 tail #connect
Ds0 f127 head f126 mainIn #connect
Ds0 f126 mainOut f130 tail #connect
Ds0 f130 head f129 mainIn #connect
Ds0 f129 mainOut f181 tail #connect
Ds0 f181 head f131 mainIn #connect
Ds0 f182 mainOut f188 tail #connect
Ds0 f188 head f184 mainIn #connect
Ds0 f184 mainOut f190 tail #connect
Ds0 f190 head f189 mainIn #connect
Ds0 f191 mainOut f193 tail #connect
Ds0 f193 head f192 mainIn #connect
Ds0 f192 mainOut f195 tail #connect
Ds0 f195 head f194 mainIn #connect
Ds0 f106 ao f196 tail #connect
Ds0 f196 head f103 @CG|ai #connect
Ds0 f197 mainOut f199 tail #connect
Ds0 f199 head f198 mainIn #connect
Ds0 f198 mainOut f201 tail #connect
Ds0 f201 head f200 mainIn #connect
Ds0 f202 mainOut f204 tail #connect
Ds0 f204 head f203 mainIn #connect
Ds0 f149 mainOut f151 tail #connect
Ds0 f151 head f150 mainIn #connect
